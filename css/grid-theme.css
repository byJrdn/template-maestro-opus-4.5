/**
 * TEMPLATE MAESTRO - Grid Theme CSS
 * 
 * Minimal, focused styling that WORKS WITH Handsontable, not against it.
 * Only overrides what's necessary for our brand and validation states.
 */

/* ============================================================
   CSS VARIABLES - Design Tokens
   ============================================================ */

:root {
    /* Brand Colors */
    --tm-primary: #6366F1;
    --tm-primary-hover: #4F46E5;

    /* Validation States */
    --tm-valid-bg: #ECFDF5;
    --tm-valid-border: #10B981;
    --tm-warning-bg: #FEF3C7;
    --tm-warning-border: #F59E0B;
    --tm-error-bg: #FEE2E2;
    --tm-error-border: #EF4444;

    /* Neutrals */
    --tm-border: #E2E8F0;
    --tm-text: #1E293B;
    --tm-text-muted: #64748B;
}

/* ============================================================
   MODAL Z-INDEX - Ensure modals appear above grid
   ============================================================ */

.modal,
[id$="-modal"],
#settings-modal,
#export-modal,
#smart-upload-modal {
    z-index: 9999 !important;
}

.modal>div,
[id$="-modal"]>div {
    z-index: 10000 !important;
}

/* Modal backdrop */
.modal::before,
.fixed.inset-0.bg-black {
    z-index: 9998 !important;
}

/* ============================================================
   GRID CONTAINER - Clean Premium Look
   ============================================================ */

#handsontable-container {
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
    border: 1px solid var(--tm-border);
    position: relative;
    z-index: 1;
}

/* ============================================================
   HEADER STYLING - Larger, Full Field Names Visible
   ============================================================ */

.handsontable th {
    background: linear-gradient(180deg, #F8FAFC 0%, #F1F5F9 100%);
    border-bottom: 2px solid var(--tm-border);
    font-weight: 600;
    color: var(--tm-text);
    font-size: 13px;
}

/* Header row with field names - allow wrapping for long names */
.handsontable thead th {
    background: linear-gradient(135deg, #6366F1 0%, #8B5CF6 100%);
    color: white;
    font-weight: 600;
    font-size: 13px;
    text-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
    padding: 10px 12px;
    min-height: 60px;
    vertical-align: top;
    line-height: 1.3;
    white-space: normal;
    word-wrap: break-word;
    text-align: center;
}

/* Row headers (numbers) */
.handsontable th.ht_clone_left {
    background: #F8FAFC;
    color: var(--tm-text-muted);
    font-weight: 500;
}

/* ============================================================
   CELL STYLING - Validation States via Classes
   ============================================================ */

/* Base cell styling */
.handsontable td {
    border-color: var(--tm-border);
    font-size: 14px;
    color: var(--tm-text);
}

/* Valid cells */
.handsontable td.cell-valid {
    background-color: var(--tm-valid-bg);
}

/* Warning cells */
.handsontable td.cell-warning {
    background-color: var(--tm-warning-bg);
    border-left: 3px solid var(--tm-warning-border);
}

/* Error cells */
.handsontable td.cell-error {
    background-color: var(--tm-error-bg);
    border-left: 3px solid var(--tm-error-border);
}

/* Conditional columns use the standard error styling when triggered and empty */
/* No special amber styling - just shows as error when validation fails */

/* Selected cell highlight */
.handsontable td.current,
.handsontable td.area {
    background-color: rgba(99, 102, 241, 0.1);
}

/* ============================================================
   DROPDOWN STYLING - Native Handsontable Dropdowns
   ============================================================ */

/* Dropdown arrow */
.handsontable .htAutocompleteArrow {
    color: var(--tm-text-muted);
}

/* Dropdown list container */
.handsontable .htMenu,
.handsontable .htDropdownMenu {
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
    border-radius: 8px;
    border: 1px solid var(--tm-border);
    overflow: hidden;
}

/* Dropdown list items */
.handsontable .htMenu td,
.handsontable .htDropdownMenu td {
    padding: 8px 12px;
}

.handsontable .htMenu td:hover,
.handsontable .htDropdownMenu td:hover {
    background-color: rgba(99, 102, 241, 0.1);
}

/* Autocomplete list */
.handsontable .listbox {
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
    border-radius: 8px;
    border: 1px solid var(--tm-border);
}

/* ============================================================
   STATUS COLUMN - First Column Styling
   ============================================================ */

.status-cell {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 6px;
    height: 100%;
}

.status-icon {
    font-size: 14px;
    font-weight: bold;
}

.status-icon.valid {
    color: var(--tm-valid-border);
}

.status-icon.warning {
    color: var(--tm-warning-border);
}

.status-icon.error {
    color: var(--tm-error-border);
}

.status-icon.pending {
    color: var(--tm-text-muted);
}

.row-num {
    font-size: 11px;
    font-weight: 500;
    color: var(--tm-text-muted);
    font-family: 'JetBrains Mono', monospace;
}

/* ============================================================
   REQUIREMENT BADGES - Styled Pills Below Field Names
   ============================================================ */

.req-badge {
    display: inline-block;
    padding: 3px 10px;
    font-size: 9px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.5px;
    border-radius: 10px;
    margin-top: 4px;
}

.req-badge.required {
    background-color: rgba(254, 226, 226, 0.9);
    color: #991B1B;
    border: 1px solid rgba(252, 165, 165, 0.8);
}

.req-badge.conditional {
    background-color: rgba(254, 243, 199, 0.9);
    color: #92400E;
    border: 1px solid rgba(252, 211, 77, 0.8);
}

.req-badge.optional {
    background-color: rgba(224, 231, 255, 0.9);
    color: #3730A3;
    border: 1px solid rgba(165, 180, 252, 0.8);
}

/* ============================================================
   SCROLLBAR STYLING - Premium Look
   ============================================================ */

.handsontable ::-webkit-scrollbar {
    width: 10px;
    height: 10px;
}

.handsontable ::-webkit-scrollbar-track {
    background: #F1F5F9;
}

.handsontable ::-webkit-scrollbar-thumb {
    background: #CBD5E1;
    border-radius: 5px;
}

.handsontable ::-webkit-scrollbar-thumb:hover {
    background: #94A3B8;
}

/* ============================================================
   TOOLTIP - Error Messages
   ============================================================ */

.grid-tooltip {
    position: fixed;
    z-index: 10000;
    background: #1E293B;
    color: white;
    padding: 8px 12px;
    border-radius: 6px;
    font-size: 12px;
    max-width: 300px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
    pointer-events: none;
}

/* ============================================================
   DELETE BUTTON
   ============================================================ */

.delete-cell {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100%;
    cursor: pointer;
    opacity: 0.3;
    transition: opacity 0.15s;
}

.delete-cell:hover {
    opacity: 1;
}

.delete-cell svg {
    width: 16px;
    height: 16px;
    stroke: #94A3B8;
}

.delete-cell:hover svg {
    stroke: #EF4444;
}